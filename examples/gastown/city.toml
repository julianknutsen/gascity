# Gas Town — expressed as a Gas City configuration.
#
# This proves the Gas City thesis: any orchestration topology is pure config.
# Two composable topologies:
#   maintenance — generic infrastructure: dog pool, shutdown dance, exec
#                 automations (gate-sweep, orphan-sweep, prune-branches,
#                 wisp-compact)
#   gastown     — domain-specific coding workflow: mayor, deacon, boot,
#                 witness, refinery, polecat, crew + dolt/digest automations
#
# City-scoped agents come from both topologies: dog (maintenance) + mayor,
# deacon, boot (gastown). Rig-scoped agents (witness, refinery, polecat)
# are stamped per-rig.
#
# To use: gc start examples/gastown/
# Requires rigs to be registered: gc rig add <path>

[workspace]
name = "gastown"
provider = "claude"
topologies = ["topologies/maintenance", "topologies/gastown"]

[daemon]
patrol_interval = "30s"
max_restarts = 5
restart_window = "1h"
shutdown_timeout = "5s"

# Register a rig to activate per-rig agents (witness, refinery, polecat):
# [[rigs]]
# name = "myproject"
# path = "/path/to/your/project"
# topology = "topologies/gastown"

# Crew members are individually named, so they can't be topology-stamped:
# [[agents]]
# name = "wolf"
# dir = "myproject"
# pre_start = ["topologies/gastown/scripts/worktree-setup.sh /path/to/myproject wolf /path/to/city --sync"]
# prompt_template = "topologies/gastown/prompts/crew.md.tmpl"
# nudge = "Check your hook and mail, then act accordingly."
# overlay_dir = "topologies/gastown/overlays/crew"
# idle_timeout = "4h"
# session_setup = [
#     "tmux set-option -t {{.Session}} status-right-length 80",
#     "tmux set-option -t {{.Session}} status-interval 5",
#     "tmux set-option -t {{.Session}} status-right '#({{.ConfigDir}}/scripts/status-line.sh {{.Agent}}) %H:%M'",
#     "{{.ConfigDir}}/scripts/bind-key.sh n \"run-shell '{{.ConfigDir}}/scripts/cycle.sh next #{session_name} #{client_tty}'\"",
#     "{{.ConfigDir}}/scripts/bind-key.sh p \"run-shell '{{.ConfigDir}}/scripts/cycle.sh prev #{session_name} #{client_tty}'\"",
#     "{{.ConfigDir}}/scripts/bind-key.sh g \"run-shell '{{.ConfigDir}}/scripts/agent-menu.sh #{client_tty}'\"",
# ]
