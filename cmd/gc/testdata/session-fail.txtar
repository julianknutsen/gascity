# Session failure tests — GC_SESSION=fail makes all session ops return errors.

env GC_SESSION=fail
env GC_BEADS=file
env GC_DOLT=skip

# gc start with broken sessions — non-fatal, still prints "City started."
# Agent start failure goes to stderr but exit code is still 0.
cd $WORK/fail-city
exec gc start
stderr 'session unavailable'
stdout 'City started.'

-- fail-city/.gc/.keep --
-- fail-city/rigs/.keep --
-- fail-city/city.toml --
[workspace]
name = "fail-city"

[[agents]]
name = "mayor"
start_command = "echo hello"
