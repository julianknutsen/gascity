# Error paths for gc CLI.

env GC_BEADS=file
env GC_DOLT=skip

# No args shows help.
exec gc
stdout 'Available Commands'

# Unknown command.
! exec gc blorp
stderr 'unknown command "blorp"'

# gc init already initialized.
exec gc init $WORK/err-city
! exec gc init $WORK/err-city
stderr 'already initialized'

# gc rig with no subcommand.
! exec gc rig
stderr 'missing subcommand'

# gc rig unknown subcommand.
! exec gc rig blorp
stderr 'unknown subcommand "blorp"'

# gc rig add with no path (need a city first).
cd $WORK/err-city
! exec gc rig add
stderr 'missing path'

# gc rig add with non-existent path.
! exec gc rig add $WORK/nonexistent
stderr 'no such file'

# gc rig add not a directory.
! exec gc rig add $WORK/err-city/city.toml
stderr 'is not a directory'

# gc rig add outside a city.
cd $WORK
! exec gc rig add $WORK/err-city
stderr 'not in a city directory'

# gc rig list outside a city.
! exec gc rig list
stderr 'not in a city directory'

# gc crew with no subcommand.
! exec gc crew
stderr 'missing subcommand'

# gc crew unknown subcommand.
! exec gc crew blorp
stderr 'unknown subcommand "blorp"'

# gc crew add without --name.
cd $WORK/err-city
! exec gc crew add
stderr 'missing.*--name'

# gc crew add duplicate.
exec gc crew add --name dupe
! exec gc crew add --name dupe
stderr 'already exists'

# gc crew list outside a city.
cd $WORK
! exec gc crew list
stderr 'not in a city directory'

# gc bead with no subcommand.
! exec gc bead
stderr 'missing subcommand'

# gc bead unknown subcommand.
! exec gc bead blorp
stderr 'unknown subcommand "blorp"'

# gc bead close with no ID (need a city first).
cd $WORK/err-city
! exec gc bead close
stderr 'missing bead ID'

# gc bead close with non-existent ID.
! exec gc bead close gc-999
stderr 'bead not found'

# gc bead create with no title (need a city first).
! exec gc bead create
stderr 'missing title'

# gc bead show with no ID.
! exec gc bead show
stderr 'missing bead ID'

# gc bead show with non-existent ID.
! exec gc bead show gc-999
stderr 'bead not found'

# gc bead create outside a city.
cd $WORK
! exec gc bead create 'test'
stderr 'not in a city directory'

# gc bead show outside a city.
! exec gc bead show gc-1
stderr 'not in a city directory'

# gc bead close outside a city.
cd $WORK
! exec gc bead close gc-1
stderr 'not in a city directory'

# gc bead list outside a city.
! exec gc bead list
stderr 'not in a city directory'

# gc bead ready outside a city.
! exec gc bead ready
stderr 'not in a city directory'

# gc agent with no subcommand.
! exec gc agent
stderr 'missing subcommand'

# gc agent unknown subcommand.
! exec gc agent blorp
stderr 'unknown subcommand "blorp"'

# gc agent attach missing name (need a city first).
cd $WORK/err-city
! exec gc agent attach
stderr 'missing agent name'

# gc agent attach — no agents configured.
cd $WORK/bare-city
! exec gc agent attach mayor
stderr 'no agents configured'

# gc agent attach — agent not found.
cd $WORK/err-city
! exec gc agent attach nonexistent
stderr 'agent "nonexistent" not found'

# gc stop not in city.
cd $WORK
! exec gc stop
stderr 'not in a city directory'

# gc stop with path not in city.
! exec gc stop $WORK/nonexistent
stderr 'not in a city directory'

-- bare-city/.gc/.keep --
-- bare-city/rigs/.keep --
-- bare-city/city.toml --
# bare config
